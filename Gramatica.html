<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gram√°tica y Fon√©tica - Shalkio</title>
    <style>
        body {
            background: #0e0e0e; color: #eee; font-family: monospace;
            padding: 20px; padding-top: 64px; animation: fadeInPage 0.4s ease-out;
        }
        @keyframes fadeInPage { from { opacity: 0; } to { opacity: 1; } }

        #navbar {
            position: fixed; top: 0; left: 0; right: 0; height: 44px;
            background: #111; border-bottom: 1px solid #333;
            display: flex; align-items: center; padding: 0 12px; z-index: 1000;
        }
        #navbar a { color: #0f0; text-decoration: none; margin-right: 16px; font-size: 14px; }

        h2, h3 { color: #0f0; text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 5px; }

        /* --- TRASNLITERADOR --- */
        #txt {
            width: 100%; height: 200px; background: #000; color: #0f0;
            border: 2px solid #0f0; padding: 15px; font-size: 1.2em;
            box-sizing: border-box; outline: none; font-family: monospace;
        }

        /* --- RESULTADOS --- */
        .grammar-results {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px; margin-top: 20px; background: #111; padding: 20px; border: 1px solid #333;
        }
        .res-card { background: #1a1a1a; padding: 12px; border-left: 3px solid #0f0; }
        .label { color: #888; font-size: 0.85em; display: block; margin-bottom: 4px; }
        .val { color: #0f0; font-size: 1.1em; font-weight: bold; word-break: break-all; }

        /* --- FON√âTICA --- */
        .phonetic-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 10px; margin-top: 20px;
        }
        .ph-item { background: #111; border: 1px solid #333; padding: 10px; text-align: center; }
        .ph-letra { color: #0f0; font-size: 1.4em; display: block; }
        .ph-sonido { color: #fff; font-style: italic; font-size: 0.9em; }

        .rules-note { background: #1a1a00; border-left: 4px solid #ff0; padding: 15px; margin: 20px 0; }
        .hl { color: #0f0; font-weight: bold; }
    </style>
</head>
<body>

<div id="navbar">
    <a href="Index.html">üí¨ Inicio</a>
    <a href="Transliterador y diccionario.html">üìò Diccionario</a>
    <a href="Gramatica.html">üìê Gram√°tica</a>
    <a href="lore.html">üìú Lore</a>
</div>

<h2>üìê Gram√°tica y Laboratorio Fon√©tico</h2>

<div style="margin-bottom: 30px;">
    <h3>üß™ Laboratorio de Transliteraci√≥n y An√°lisis</h3>
    <p>Escribe aqu√≠ para transliterar y analizar la gram√°tica de la √∫ltima palabra:</p>
    
    <textarea id="txt" placeholder="Escribe en Shalkio Latinizado..."></textarea>

<div class="grammar-results">
    <div class="res-card"><span class="label">An√°lisis de:</span><span class="val" id="wordTarget">-</span></div>
    <div class="res-card"><span class="label">Plural:</span><span class="val" id="pluralOut">-</span></div>
    <div class="res-card"><span class="label">Pasado:</span><span class="val" id="pasadoOut">-</span></div>
    <div class="res-card"><span class="label">Futuro:</span><span class="val" id="futuroOut">-</span></div> </div>%ana
</div>

<h3>üîä Alfabeto Fon√©tico (AFI)</h3>
<div class="phonetic-grid" id="ipaTable"></div>

<h3>üîä Reglas Fon√©ticas Especiales</h3>

<div class="grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
    
    <div class="card" style="background: #111; border: 1px solid #333; padding: 15px; border-top: 4px solid #0f0;">
        <h4 style="color: #0f0; margin-top: 0;">La Regla de la "–û"</h4>
        <p>La pronunciaci√≥n de la letra <span class="hl">–û</span> es din√°mica y depende de su entorno:</p>
        <ul>
            <li><b>Sonido /o/:</b> Cuando una <span class="hl">–û</span> lleva tilde (marcador de vocal fuerte).</li>
            <li><b>Sonido /a/:</b> Si en la palabra ninguna <span class="hl">–û</span> est√° acentuada, <b>todas</b> las <span class="hl">–û</span> en la palabra pasan a sonar como <span class="hl">/a/</span>.</li>
        </ul>
    </div>

    <div class="card" style="background: #111; border: 1px solid #333; padding: 15px; border-top: 4px solid #ff0;">
        <h4 style="color: #ff0; margin-top: 0;">Signos Fuertes y D√©biles</h4>
        
        <p><b>Signo Fuerte (<span class="hl">—ä</span>):</b></p>
        <ul>
            <li>Tras consonante: Se pronuncia como <span class="hl">/j/</span>.</li>
            <li>Tras vocal: Aumenta la intensidad (similar a un acento leve).</li>
        </ul>

        <p><b>Signo D√©bil (<span class="hl">—å</span>):</b></p>
        <ul>
            <li>Tras consonante: Palataliza la letra con cualidad <span class="hl">/i/</span>.</li>
            <li>Tras vocal fuerte: Reduce su intensidad.</li>
            <li>Tras vocal d√©bil: Transforma el sonido radicalmente:
                <table style="font-size: 0.8em; margin-top: 5px;">
                    <tr><td>–ê + —å ‚Üí <b>/…í/</b></td><td>–≠ + —å ‚Üí <b>/…ô/</b></td></tr>
                    <tr><td>–ò + —å ‚Üí <b>/…®/</b></td><td>–û + —å ‚Üí <b>/…î/</b></td></tr>
                    <tr><td>–£ + —å ‚Üí <b>/≈ì/</b></td><td></td></tr>
                </table>
            </li>
        </ul>
    </div>
</div>

<div class="rules-note" style="background: #1a1a00; border-left: 4px solid #0f0; padding: 15px; margin-top: 20px;">
    <p><b>Nota sobre la Escritura:</b> En el d√≠a a d√≠a, la tilde no se escribe. Solo se utiliza en el diccionario para marcar la vocal fuerte y diferenciar significados. La √∫nica excepci√≥n es la letra <span class="hl">–Å</span>, que siempre mantiene su forma.</p>
</div>

<script>
const txt = document.getElementById("txt");
const dict = {"Ch":"–ß","–óh":"–ñ","–öh":"–•'","√ách":"–©","G'":"“ê","Ye":"–ï","Yo":"–Å","√áh":"–®","Ya":"–Ø","Yu":"–Æ","Y'":"–´","A":"–ê","B":"–ë","V":"–í","G":"–ì","D":"–î","K":"–ö","T":"–¢","J":"–•","F":"–§","L":"–õ","M":"–ú","N":"–ù","O":"–û","P":"–ü","R":"–†","S":"√á","U":"–£","Z":"–ó","I":"–ò","E":"–≠","ch":"—á","–∑h":"–∂","–∫h":"—Ö'","√ßch":"—â","g'":"“ë","ye":"–µ","yo":"—ë","ya":"—è","yu":"—é","y'":"—ã","√ßh":"—à","a":"–∞","b":"–±","v":"–≤","g":"–≥","d":"–¥","k":"–∫","t":"—Ç","j":"—Ö","f":"—Ñ","l":"–ª","m":"–º","n":"–Ω","o":"–æ","p":"–ø","r":"—Ä","s":"√ß","u":"—É","z":"–∑","i":"–∏","e":"—ç"};
const keys = Object.keys(dict).sort((a,b)=>b.length-a.length);

txt.addEventListener("input", () => {
    let v = txt.value;
    for(const k of keys){ v = v.replace(new RegExp(k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"), dict[k]); }
    txt.value = v;
    analyzeGrammar(v);
});

txt.addEventListener("keydown", e => {
    if (e.key !== "Tab") return;
    e.preventDefault();
    const pos = txt.selectionStart;
    const text = txt.value;
    const apply = (off, val) => {
        txt.value = text.slice(0, pos-off) + val + text.slice(pos);
        txt.selectionStart = txt.selectionEnd = pos - off + val.length;
    };
    const c1 = text.slice(pos-1, pos), c2 = text.slice(pos-2, pos);
    if(c2==="–¢√ß") return apply(2,"–°"); if(c2==="—Ç√ß") return apply(2,"—Å"); if(c2==="''") return apply(2,"—ä");
    if(c1==="–ì") return apply(1,"“ê"); if(c1==="–≥") return apply(1,"“ë"); if(c1==="'") return apply(1,"—å");
    if(c1==="Y") return apply(1,"–ô"); if(c1==="y") return apply(1,"–π");
});

/* ================= AN√ÅLISIS GRAMATICAL (SUFIJOS FIJOS) ================= */
function analyzeGrammar(fullText) {
    const words = fullText.trim().split(/\s+/);
    const w = words[words.length - 1]; 
    if(!w) {
        clearFields();
        return;
    }

    document.getElementById("wordTarget").textContent = w;

    // --- REGLA PLURAL ---
    let plural = (w.endsWith("—è") || w.endsWith("–∞") || w.endsWith("–Ø") || w.endsWith("–ê")) 
                 ? w + "√ß" : w + "—è";
    document.getElementById("pluralOut").textContent = plural;

    // --- REGLA PASADO ---
    let pasado = (w.endsWith("–∏") || w.endsWith("–π") || w.endsWith("—ã") || 
                  w.endsWith("–ò") || w.endsWith("–ô") || w.endsWith("–´")) 
                 ? w + "–∫—É" : w + "—ã—Ç";
    document.getElementById("pasadoOut").textContent = pasado;

    // --- REGLA FUTURO (NUEVA) ---
    // Simplemente agregamos "–º–∞" al final de la ra√≠z
    let futuro = w + "–º–∞";
    document.getElementById("futuroOut").textContent = futuro;
}

// Funci√≥n auxiliar para limpiar si no hay texto
function clearFields() {
    ["wordTarget", "pluralOut", "pasadoOut", "futuroOut"].forEach(id => {
        document.getElementById(id).textContent = "-";
    });
}

const ipa = [{l:"–ê",s:"/a/"},{l:"–ë",s:"/b/"},{l:"–í",s:"/v/"},{l:"–ì",s:"/g/"},{l:"“ê",s:"/…° ≤/"},{l:"–ï",s:"/je/"},{l:"–Å",s:"/jo/"},{l:"–°",s:"/ts/"},{l:"–î",s:"/d/"},{l:"–ö",s:"/k/"},{l:"–•'",s:"/k ∞/"},{l:"–•",s:"/x/"},{l:"–§",s:"/f/"},{l:"–õ",s:"/…´/"},{l:"M",s:"/m/"},{l:"–ù",s:"/n/"},{l:"–û",s:"/o/~/a/"},{l:"–ü",s:"/p/"},{l:"–†",s:"/r/"},{l:"√á",s:"/s/"},{l:"–¢",s:"/t/"},{l:"–£",s:"/u/"},{l:"–ó",s:"/z/"},{l:"–ñ",s:"/ í/"},{l:"–ò",s:"/i/"},{l:"–ô",s:"/j/"},{l:"–´",s:"/…®/"},{l:"–Ø",s:"/ja/"},{l:"–Æ",s:"/ju/"},{l:"–ß",s:"/t É/"},{l:"–®",s:"/ É/"},{l:"–©",s:"/…ïÀê~/ Ét É//"},{l:"–≠",s:"/e/"}];
const ipaTable = document.getElementById("ipaTable");
ipa.forEach(i => { ipaTable.innerHTML += `<div class="ph-item"><span class="ph-letra">${i.l}</span><span class="ph-sonido">${i.s}</span></div>`; });
</script>
</body>
</html>